model InfrastructureNode {
  id String @id @default(uuid())

  taskName String
  slug     String @unique

  nodeType  String?
  programId String? // no relation just take it as ref

  duration            Int      @default(0)
  startDate           DateTime @default(now())
  finishDate          DateTime @default(now())
  priority            String   @default("NONE")
  actualHour          Float    @default(0)
  plannedHour         Float    @default(0)
  plannedCost         Float    @default(0)
  plannedResourceCost Float    @default(0)

  // Progress 
  progress         Float? // only leaf
  computedProgress Float   @default(0)
  weight           Float   @default(1)
  isLeaf           Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations - link with project
  projectId String
  project   Project @relation(fields: [projectId], references: [id])
  parentId  String? // null = top-level node under project

  parent   InfrastructureNode?  @relation("NodeChildren", fields: [parentId], references: [id])
  children InfrastructureNode[] @relation("NodeChildren")

  @@index([projectId])
  @@index([parentId])
  @@index([isLeaf])
  @@index([slug, id])
}
